<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–æ–Ω–∏–º–µ–Ω –ß–∞—Ç</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
    <div class="min-h-screen flex">
        <!-- Left: Marketing -->
        <div class="hidden lg:block lg:w-1/2 bg-gradient-to-br from-blue-900 to-purple-900 p-12">
            <h1 class="text-4xl font-bold mb-4">üì± –ê–Ω–æ–Ω–∏–º–µ–Ω –ß–∞—Ç</h1>
            <p class="text-xl mb-8">‚Ç¨5 / $5 –Ω–∞ –º–µ—Å–µ—Ü</p>
            
            <div class="space-y-6">
                <div>
                    <h3 class="text-xl font-bold text-green-400 mb-2">‚úÖ –ú–æ–∂–µ—à:</h3>
                    <ul class="space-y-1 text-sm">
                        <li>üìû –ü–æ–∑–Ω–∞—Ç–∏: –¢–µ–ª–µ—Ñ–æ–Ω ‚Üí —á–∞—Ç</li>
                        <li>üíï –ó–∞–ø–æ–∑–Ω–∞–Ω—Å—Ç–≤–∞: –¢—ä—Ä—Å–∏ –ø–æ –ø–æ–ª/—Ä—ä—Å—Ç/—Ç–µ–≥–ª–æ/–¥—ä—Ä–∂–∞–≤–∞</li>
                        <li>üìÅ –§–∞–π–ª–æ–≤–µ –¥–æ 100MB (—Ç—Ä–∏—è—Ç —Å–µ —Å–ª–µ–¥ —Å–≤–∞–ª—è–Ω–µ)</li>
                        <li>üîÑ –ò—Å—Ç–æ—Ä–∏—è: 5KB (—Å—Ç–∞—Ä–æ—Ç–æ —Å–µ —Ç—Ä–∏–µ)</li>
                    </ul>
                </div>

                <div>
                    <h3 class="text-xl font-bold text-red-400 mb-2">‚ùå –ù–ï –º–æ–∂–µ—à:</h3>
                    <ul class="space-y-1 text-sm">
                        <li>üïµÔ∏è –¢—ä—Ä—Å–µ–Ω–µ –ø–æ –∏–º–µ/–≥—Ä–∞–¥/—É–ª–∏—Ü–∞/—Ä–∞–±–æ—Ç–∞</li>
                        <li>üîç "–ù–∞–º–µ—Ä–∏ –Æ–ª–∏—è –æ—Ç –û'—à–∏–ø–∫–∞" - –¥–µ—Ç–µ–∫—Ç–∏–≤—Å–∫–æ –±—é—Ä–æ</li>
                        <li>üìù –î—ä–ª–≥–æ—Å—Ä–æ—á–Ω–∞ –∏—Å—Ç–æ—Ä–∏—è</li>
                    </ul>
                </div>

                <div class="text-sm opacity-75">
                    üîí –ë–µ–∑ SMS ‚Ä¢ üìß –ë–µ–∑ Email ‚Ä¢ üóëÔ∏è –§–∞–π–ª–æ–≤–µ —Å–µ —Ç—Ä–∏—è—Ç
                </div>
            </div>
        </div>

        <!-- Right: Login -->
        <div class="w-full lg:w-1/2 flex items-center justify-center p-8">
            <div class="max-w-md w-full">
                <!-- Mobile Marketing -->
                <div class="lg:hidden mb-8 text-center">
                    <h1 class="text-3xl font-bold mb-2">üì± –ê–Ω–æ–Ω–∏–º–µ–Ω –ß–∞—Ç</h1>
                    <p class="text-gray-400">‚Ç¨5 / $5 –Ω–∞ –º–µ—Å–µ—Ü</p>
                </div>

                <!-- Login Form -->
                <div class="bg-gray-800 rounded-lg p-8">
                    <form id="loginForm" class="space-y-4">
                        <input 
                            type="tel" 
                            id="phone" 
                            placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" 
                            class="w-full p-4 bg-gray-700 rounded text-white text-lg" 
                            required
                        >
                        <input 
                            type="password" 
                            id="password" 
                            placeholder="–ü–∞—Ä–æ–ª–∞" 
                            class="w-full p-4 bg-gray-700 rounded text-white text-lg" 
                            required
                        >
                        <button 
                            type="submit" 
                            class="w-full bg-blue-600 hover:bg-blue-700 py-4 rounded font-bold text-lg"
                        >
                            –í–ª–µ–∑
                        </button>
                    </form>
                    <div id="message" class="mt-4 text-center"></div>
                </div>

                <!-- Mobile Marketing Details -->
                <div class="lg:hidden mt-6 text-sm text-gray-400 text-center">
                    <p>‚úÖ –ü–æ–∑–Ω–∞—Ç–∏ ‚Ä¢ –ó–∞–ø–æ–∑–Ω–∞–Ω—Å—Ç–≤–∞ ‚Ä¢ –§–∞–π–ª–æ–≤–µ</p>
                    <p>‚ùå –ë–µ–∑ —Ç—ä—Ä—Å–µ–Ω–µ –ø–æ –∏–º–µ/–≥—Ä–∞–¥</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const phone = document.getElementById('phone').value;
            const password = document.getElementById('password').value;
            const messageDiv = document.getElementById('message');

            messageDiv.innerHTML = '<p class="text-gray-400">–ó–∞—Ä–µ–∂–¥–∞–Ω–µ...</p>';

            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phone, password })
                });

                const data = await response.json();

                if (data.needsRegistration) {
                    // User doesn't exist ‚Üí Register
                    window.location.href = `/register.html?phone=${encodeURIComponent(phone)}&password=${encodeURIComponent(password)}`;
                } else if (data.isBlocked) {
                    // Blocked ‚Üí –î—É—Ö–∞ —Å—É–ø–∞—Ç–∞
                    messageDiv.innerHTML = '<p class="text-red-400">–ê–∫–∞—É–Ω—Ç—ä—Ç –µ –±–ª–æ–∫–∏—Ä–∞–Ω</p>';
                } else if (data.needsPayment) {
                    // Not paid ‚Üí Payment page
                    localStorage.setItem('userId', data.userId);
                    window.location.href = `/payment.html`;
                } else if (data.success) {
                    // Success ‚Üí Chat
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('userId', data.userId);
                    window.location.href = '/chat.html';
                } else {
                    messageDiv.innerHTML = `<p class="text-red-400">${data.error || '–ì—Ä–µ—à–∫–∞'}</p>`;
                }
            } catch (err) {
                console.error(err);
                messageDiv.innerHTML = '<p class="text-red-400">–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ —Å–≤—ä—Ä–∑–≤–∞–Ω–µ</p>';
            }
        });
    </script>
</body>
</html>
